<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>calculator</title>
  <style>
    * {
      box-sizing: border-box;
    }

    .display {
      background-color: rgba(0, 0, 0, 0.5);
      width: 390px;
      height: 100px;
      margin: 5px auto;
      padding: 5px;
      font-size: 30px;
      line-height: 90px;
      text-align: right;
    }

    #calc_wapper {
      width: 400px;
      height: 590px;
      background-color: lightgreen;
      margin: 0px auto;
    }

    #btn {
      display: flex;
      flex-flow: row wrap;
      justify-content: center;
      align-items: center;
      width: 100%;
    }

    .num_key,
    .op_key,
    .c_key,
    .back_key,
    .equal_key,
    .point_key {
      width: 93px;
      height: 70px;
      margin: 2px;
      font-size: 40px;
    }

    .back_key {
      width: 190px;
    }

    .c_key {
      width: 190px;
    }
  </style>
</head>

<body>
  <div id="calc_wapper">
    <div class="display" id="result"></div>
    <div class="display" id="calc"></div>
    <div id="btn">
      <button class="back_key" value="back" id="back">Back</button>
      <button class="c_key" value="c" id="c">C</button>
      <button class="num_key" value="7">7</button>
      <button class="num_key" value="8">8</button>
      <button class="num_key" value="9">9</button>
      <button class="op_key" value="/">/</button>
      <button class="num_key" value="4">4</button>
      <button class="num_key" value="5">5</button>
      <button class="num_key" value="6">6</button>
      <button class="op_key" value="*">*</button>
      <button class="num_key" value="1">1</button>
      <button class="num_key" value="2">2</button>
      <button class="num_key" value="3">3</button>
      <button class="op_key" value="-">-</button>
      <button class="point_key" value=".">.</button>
      <button class="num_key" value="0">0</button>
      <button class="equal_key" value="=">=</button>
      <button class="op_key" value="+">+</button>
    </div>
  </div>
  <script>
    //DOM
    const displayResult = document.getElementById('result');
    const displayCalc = document.getElementById('calc');
    const numKeys = document.getElementsByClassName('num_key');
    const opKeys = document.getElementsByClassName('op_key');
    const backKey = document.querySelector('.back_key');
    const cKey = document.querySelector('.c_key');
    const pointKey = document.querySelector('.point_key');
    const equalKey = document.querySelector('.equal_key');

    //variable
    let operand1;
    let operand2;
    let op;
    let result;

    init();

    //function
    function init() {
      operand1 = null;
      operand2 = null;
      op = null;
      result = null;
      if (operand1 == null) {
        displayCalc.innerText = 0;
        displayResult.innerText = 0;
      }
    }
    function pressNumKey(e) {
      let tmp = parseInt(e.target.value);
      displayCalcUpdate(tmp);
      displayResultUpdate(tmp);
    }
    function pressOpKey(e) {
      op = e.target.value;
      setOperand();
      displayResultUpdate(op);
    }
    function pressEqualKey() {
      setOperand();
      calc();
    }
    function pressBackKey() {
      if (displayCalc.innerText != 0) {
        let tmp = parseInt(displayCalc.innerText.slice(0, -1));
        displayCalc.innerText = 0;
        displayCalcUpdate(tmp);
        let tmp2 = displayResult.innerText.slice(0, -1);
        displayResult.innerText = '';
        displayResultUpdate(tmp2);
      }
    }
    function displayCalcUpdate(num) {
      if (isNaN(num)) {
        num = 0;
      }
      if (displayCalc.innerText == 0) {
        let tmp = Number(displayCalc.innerText);
        displayCalc.innerHTML = tmp + num;
      } else {
        displayCalc.innerText += num;
      }
    }
    function displayResultUpdate(num) {
      if (displayResult.innerText == 0) {
        let tmp = Number(displayResult.innerText);
        displayResult.innerText = tmp + num;
      } else {
        displayResult.innerText += num;
      }
    }
    function setOperand() {
      if (result != null) {
        operand1 = result;
        result = null;
        displayCalc.innerText = 0;
      } else if (operand1 == null) {
        operand1 = displayCalc.innerText;
        displayCalc.innerText = 0;
      } else {
        operand2 = displayCalc.innerText;
        displayCalc.innerText = 0;
      }
    }
    function calc() {
      switch (op) {
        case '+':
          result = Number(operand1) + Number(operand2);
          break;
        case '-':
          result = Number(operand1) - Number(operand2);
          break;
        case '*':
          result = Number(operand1) * Number(operand2);
          break;
        case '/':
          result = Number(operand1) / Number(operand2);
          break;
      }
      displayResultUpdate(equalKey.value);
      displayResultUpdate(result);
      displayCalcUpdate(result);
    }

    //event handler
    for (let i = 0; i < numKeys.length; i++) {
      numKeys[i].addEventListener('click', pressNumKey);
    }
    for (let i = 0; i < opKeys.length; i++) {
      opKeys[i].addEventListener('click', pressOpKey);
    }
    cKey.addEventListener('click', init);
    equalKey.addEventListener('click', pressEqualKey);
    backKey.addEventListener('click', pressBackKey);
    // pointKey.addEventListener('click', pressPointKey);
  </script>
</body>

</html>